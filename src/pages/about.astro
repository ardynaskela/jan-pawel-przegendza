---
import H1 from "../components/h1.astro";
import H2 from "../components/h2.astro";
import InfoLayout from "../layouts/InfoLayout.astro";
import { getEntry } from "astro:content";

type Award = {
  title: string;
  year?: number;
  description?: string;
};

// Pobierz bio i awards z osobnych plików
const bioEntry = await getEntry("about", "bio");
const awardsEntry = await getEntry("about", "awards");

if (!bioEntry) throw new Error("Missing bio entry: src/content/about/bio.md");
if (!awardsEntry) throw new Error("Missing awards entry: src/content/about/awards.md");

const { Content: BioContent } = await bioEntry.render();

const title = bioEntry.data.title ?? "Jan Paweł Przegendza";
const awards: Award[] = awardsEntry.data.awards ?? [];

const imageSrc = bioEntry.data.photo ?? "/uploads/jan-przegendza.jpg";
const imageAlt = bioEntry.data.photoAlt ?? title;
---

<InfoLayout imageSrc={imageSrc} imageAlt={imageAlt}>
  <div class="space-y-16">
    <section class="space-y-2 sm:space-y-4">
      <H1>{title}</H1>
      <div class="prose prose-invert max-w-none prose-lg xl:prose-xl prose-p:leading-snug prose-li:leading-snug">
        <BioContent />
      </div>
    </section>

    <section class="space-y-2 sm:space-y-2">
      <H2>{awardsEntry.data.title ?? "Awards"}</H2>

      {awards.length > 0 ? (
        <div class="prose prose-invert max-w-none prose-lg xl:prose-xl prose-p:leading-snug text-neutral-200">
          <ul class="not-prose list-none m-0 p-0 space-y-2">
            {awards.map((a: Award) => (
              <li class="flex items-start gap-2">
                <span aria-hidden="true" class="shrink-0 leading-snug text-2xl">•</span>
                <div class="min-w-0">
                  <span class="font-medium">{a.title}</span>
                  {a.year && <span> ({a.year})</span>}
                  {a.description && <span> — {a.description}</span>}
                </div>
              </li>
            ))}
          </ul>
        </div>
      ) : (
        <p class="text-neutral-200">No awards yet.</p>
      )}
    </section>
  </div>
</InfoLayout>
